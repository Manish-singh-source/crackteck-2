# spatie/laravel-backup README

spatie/laravel-backup is a reliable package that creates backups of your Laravel application's files and databases. It zips everything together and stores it on disks like local storage, S3, or others you configure.

## Installation Steps

Start by requiring the package with Composer in your Laravel project terminal.

```
composer require spatie/laravel-backup
```

Next, publish the configuration file to customize settings like what to backup and where to store it.

```
php artisan vendor:publish --provider="Spatie\\Backup\\BackupServiceProvider" --tag=backup-config
```

This creates `config/backup.php`. Review it to set your app name, include/exclude files, databases, and destination disks.

Optionally publish translations if needed.

```
php artisan vendor:publish --provider="Spatie\\Backup\\BackupServiceProvider" --tag=backup-translations
```


## Basic Usage

Run backups using Artisan commands. The main command creates a full backup of files and databases.

```
php artisan backup:run
```

List existing backups on all disks.

```
php artisan backup:list
```

Clean up old backups based on your config rules.

```
php artisan backup:clean
```

Monitor backup health, like checking if backups are too old or using too much space.

```
php artisan backup:monitor
```

These commands work right after installation, but schedule them for automation.

## Usage Examples

### Example 1: Scheduled Daily Backups

Add these to your `app/Console/Kernel.php` schedule method (or `routes/console.php` in Laravel 11+).

```php
use Illuminate\Support\Facades\Schedule;

$schedule->command('backup:clean')->daily()->at('01:00');
$schedule->command('backup:run')->daily()->at('02:00');
```

This cleans old backups first, then creates a new one daily. Don't schedule during daylight saving changes (avoid 02:00-03:00).

### Example 2: Database-Only or Files-Only Backup

For quick database backup only:

```
php artisan backup:run --only-db
```

For files only (skip databases):

```
php artisan backup:run --only-files
```

Backup to a specific disk like S3:

```
php artisan backup:run --only-to-disk=s3
```

Use these carefully, as monitoring treats partial backups the same as full ones.

## Configuration Highlights

Edit `config/backup.php` for your needs.

- **Source**: Set `files.include` (e.g., `base_path()`) and `exclude` (e.g., `vendor`, `node_modules`). List database connections in `databases` (e.g., `mysql`).
- **Destination**: Add disks like `s3`, `dropbox` in `disks` array. Avoid only using `local` for safety.
- **Cleanup**: Default strategy keeps all backups 7 days, dailies 16 days, etc., and limits total size to 5000MB.
- **Notifications**: Enable mail or Slack for failures via `notifications`.
- **Monitor**: Set health checks like max age (1 day) or storage (5000MB).

Configure external disks in `config/filesystems.php` first.

## Production vs Development Differences

In development, use `local` disk for quick testing on your machine. Backups save to `storage/app/Laravel` and are easy to inspect.

In production, always use multiple remote disks like S3 or Dropbox to avoid data loss if the server fails. Increase cleanup limits (e.g., more days/MB), enable encryption with `password`, and notifications for alerts. Schedule via cron (`* * * * * php artisan schedule:run >> /dev/null 2>&1`), monitor strictly, and test restores regularly. Development skips these for speed.

## Removal Steps

Remove the package safely to avoid errors.

1. Run cleanup one last time: `php artisan backup:clean`
2. Delete from `composer.json` or run: `composer remove spatie/laravel-backup`
3. Clear config cache: `php artisan config:clear`
4. Delete `config/backup.php` and any published translations.
5. Remove scheduled commands from `app/Console/Kernel.php`.
6. Delete backup directories if no longer needed (e.g., `storage/app/backup-temp`).

Clear caches again if Artisan commands fail post-removal.

<div align="center">‚ÅÇ</div>